# Проектная работа "Веб-ларек"
 

Стек: HTML, SCSS, TS, Webpack

Структура проекта:
- src/ — исходные файлы проекта
- src/components/ — папка с JS компонентами
- src/components/base/ — папка с базовым кодом

Важные файлы:
- src/pages/index.html — HTML-файл главной страницы
- src/types/index.ts — файл с типами
- src/index.ts — точка входа приложения
- src/styles/styles.scss — корневой файл стилей
- src/utils/constants.ts — файл с константами
- src/utils/utils.ts — файл с утилитами

## Установка и запуск
Для установки и запуска проекта необходимо выполнить команды

```
npm install
npm run start
```

или

```
yarn
yarn start
```
## Сборка

```
npm run build
```

или

```
yarn build
```
## Данные и типы данных, используемые в приложении

### Карточка товара
```
export interface ICard {
	id: string;
	description: string;
	image: string;
	title: string;
	category: string;
	price: number | null;
}
```

### Результат заказа
```
export interface IOrderResult {
	id: string[];
	total: number;
	error?: string;
}
```

### Данные в корзине
```
export interface IOrder {
	email: string;
	phone: string;
	address: string;
	total: number;
	items: string[];
}
```

### Данные товара в карточке
```
export type TCardInfo = Pick<
	IProduct,
	'category' | 'title' | 'image' | 'price'
>;
```

### Данные товара в попапе открытя карточки
```
export type TCardPopup = Pick<
	ICard,
	'category' | 'title' | 'image' | 'price' | 'description'
>;
```

### Данные товара в попапе корзины
```
export type TBasketPopup = Pick<ICard, 'title' | 'price'>;
```

## Архитектура приложения

Код приложения разделен на слои согласно парадигме MVP:
- слой представления, отвечает за отображение данных на странице,
- слой данных, отвечает за хранение и изменение данных
- презентер, отвечает за связь представления и данных.

### Базовый код

#### Класс Арі
Содержит в себе базовую логику отправки запросов. В конструктор передается базовый адрес сервера и опциональный объект с заголовками запросов.
Методы:
- `get` - выполняет GET запрос на переданный в параметрах ендпоинт и возвращает промис с объектом, которым ответил сервер
- `post` - принимает объект с данными, которые будут переданы в JSON в теле запроса, и отправляет эти данные на ендпоинт переданный как параметр при вызове метода. По умолчанию выполняется `POST` запрос, но метод запроса может быть переопределен заданием третьего параметра при вызове.

#### Класс EventEmitter
Брокер событий позволяет отправлять события и подписываться на события, происходящие в системе. Класс используется в презентере для обработки событий и в слоях приложения для генерации событий.
Основные методы, реализуемые классом описаны интерфейсом `IEvents`:
- `on` - подписка на событие
- `emit` - инициализация события
- `trigger` - возвращает функцию, при вызове которой инициализируется требуемое в параметрах событие

### Слой данных

#### Класс BasketData
Класс отвечает за отображение корзины
Конструктор класса принимает HTMLElement и экземпляр класса EventEmitter для инициации событий при изменении данных.
Ключевые свойства и методы:
- totalCost общая стоимость товаров в корзине
- itemsList список товаров в корзине

#### Класс Popup
Класс отвечает за отображение попапа (модального окна)
Конструктор класса принимает HTMLElement для отображения в попапе и EventEmitter для взаимодействия с другими компонентами.
Ключевые свойства и методы:
- content компонент который отображается в модальном окне
- open() открыть модальное окно
- close() закрыть модальное окно
- show() отобразить модальное окно в компоненте

#### Класс AppApi
Принимает в конструктор экземпляр класса Api и предоставляет методы реализующие взаимодействие с бэкендом сервиса.

## Взаимодействие компонентов
Код, описывающий взаимодействие представления и данных между собой находится в файле `index.ts`, выполняющем роль презентера.\
Взаимодействие осуществляется за счет событий генерируемых с помощью брокера событий и обработчиков этих событий, описанных в `index.ts`\
В `index.ts` сначала создаются экземпляры всех необходимых классов, а затем настраивается обработка событий.